{
    "type": "module",
    "name": "server",
    "version": "1.0.0",
    "description": "",
    "main": "index.js",
    "scripts":
    {
        "start": "npm run dev",
        "dev": "wrangler dev --local",
        "deploy": "wrangler deploy",
        "predeploy": "npm run db:migrate",
        "postdeploy": "npm run backfill:auto",
        "tail": "wrangler tail",
        "secrets:list": "wrangler secret list",
        "secrets:check": "sh -c 'curl -s \"https://netsuite-bi-ingest.mitchbiworker.workers.dev/api/debug/db\" | jq .'",
        "db:psql": "psql \"$DATABASE_URL\"",
        "db:migrate": "psql -v ON_ERROR_STOP=1 \"$DATABASE_URL\" -f sql/001_kpi_views.sql",
        "backfill:one": "sh -c 'STORE=\"$1\"; DAYS=\"${DAYS:-365}\"; RESET=\"${RESET:-false}\"; TOKEN_OPT=\"\"; [ -n \"$BACKFILL_TOKEN\" ] && TOKEN_OPT=\"&token=$BACKFILL_TOKEN\"; curl -s -X POST \"https://netsuite-bi-ingest.mitchbiworker.workers.dev/api/admin/backfill?days=$DAYS&store=$STORE&hard_reset=$RESET$TOKEN_OPT\" | jq .' --",
        "backfill:ees:reset": "RESET=true npm run backfill:one -- essential-electric-supply.myshopify.com",
        "backfill:cbg:reset": "RESET=true npm run backfill:one -- cbguys.myshopify.com",
        "backfill:uf:reset": "RESET=true npm run backfill:one -- united-fuses.myshopify.com",
        "backfill:all:reset": "npm run backfill:ees:reset && sleep 5 && npm run backfill:cbg:reset && sleep 5 && npm run backfill:uf:reset",
        "backfill:ees": "npm run backfill:one -- essential-electric-supply.myshopify.com",
        "backfill:cbg": "npm run backfill:one -- cbguys.myshopify.com",
        "backfill:uf": "npm run backfill:one -- united-fuses.myshopify.com",
        "backfill:all": "npm run backfill:ees && sleep 5 && npm run backfill:cbg && sleep 5 && npm run backfill:uf",
        "backfill:auto": "DAYS=30 npm run backfill:all && sleep 5 && DAYS=365 npm run backfill:all && sleep 5 && DAYS=365 npm run backfill:all",
        "kpis:top-skus": "curl -s \"https://netsuite-bi-ingest.mitchbiworker.workers.dev/api/kpis/top-skus?days=30&limit=10\" | jq .",
        "kpis:bottom-skus": "curl -s \"https://netsuite-bi-ingest.mitchbiworker.workers.dev/api/kpis/bottom-skus?days=30&limit=10\" | jq .",
        "kpis:daily": "curl -s \"https://netsuite-bi-ingest.mitchbiworker.workers.dev/api/kpis/daily?days=14\" | jq .",
        "kpis:rolling": "curl -s \"https://netsuite-bi-ingest.mitchbiworker.workers.dev/api/kpis/rolling\" | jq .",
        "commit": "git add . && git commit -m \"auto: update + deploy\" && git push origin main",
        "ship": "npm run commit && npm run deploy",
        "menu": "node tools/menu.js",
        "test": "echo \"Error: no test specified\" && exit 1"
    },
    "keywords":
    [],
    "author": "",
    "license": "ISC",
    "dependencies":
    {
        "@neondatabase/serverless": "^0.10.4"
    }
}