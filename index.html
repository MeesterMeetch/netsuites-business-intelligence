<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Business Intelligence by Mitch</title>

  <!-- Mobile / Theme -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="theme-color" content="#2a5298" />

  <!-- Libs -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <!-- Styles -->
  <link rel="stylesheet" href="css/styles.css" />
  <style>
    /* Small helpers for tables/panels */
    .panel{margin:2rem 0}
    .table-wrap{overflow:auto;border:1px solid #e6e8eb;border-radius:12px;background:#fff}
    .table th,.table td{border-bottom:1px solid #eef1f4}
    .table th{font-weight:600;color:#344054;background:#fafbfc}
    .metric-value{font-variant-numeric:tabular-nums}
    .muted{color:#6b7280}
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header-nav">
    <div class="nav-container">
      <div class="logo-section">
        <a href="#" class="logo" onclick="PlatformActions?.showOverview?.()">ğŸ“Š BI by Mitch</a>
        <div class="platform-status">Data sources: NetSuite + Shopify</div>
      </div>
      <nav>
        <ul class="nav-links">
          <li><a href="#overview" class="active" onclick="PlatformActions?.showOverview?.()">Overview</a></li>
          <li><a href="#product-intelligence" onclick="PlatformActions?.showProductIntelligence?.()">Product Intelligence</a></li>
          <li><a href="#treasury-management" onclick="PlatformActions?.showTreasuryManagement?.()">Treasury Management</a></li>
          <li><a href="#reports" onclick="PlatformActions?.exportPlatformReport?.()">Reports</a></li>
          <li><a href="#export" onclick="PlatformActions?.exportDashboard?.()">Export</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="container">
    <!-- Overview -->
    <section id="overview" class="platform-overview">
      <div class="overview-header">
        <h1 class="overview-title">Business Intelligence by Mitch</h1>
        <p class="overview-subtitle">
          Unified analytics across NetSuite + Shopify â€” instant storeâ€‘level KPIs and product intelligence.
        </p>
        <div id="error-banner" class="muted" style="margin-top:.5rem;"></div>
      </div>

      <!-- Store selector -->
      <div style="display:flex; gap:1rem; align-items:center; margin: 0 0 1.25rem;">
        <label for="shop-selector" style="font-weight:600;">Store:</label>
        <select id="shop-selector" style="padding:.5rem .75rem; min-width:260px; border-radius:10px; border:1px solid #d0d7de;"></select>
      </div>
      
      <!-- Sales window + Export -->
<div class="controls" style="display:flex; gap:.75rem; align-items:center; flex-wrap:wrap; margin: .5rem 0 1rem;">
  <label for="sales-window" style="font-weight:600;">Window:</label>
  <select id="sales-window" style="padding:.5rem .75rem; min-width:160px; border-radius:10px; border:1px solid #d0d7de;">
    <option value="1">1 day</option>
    <option value="7">7 days</option>
    <option value="14" selected>14 days</option>
    <option value="30">30 days</option>
    <option value="90">90 days</option>
    <option value="365">365 days</option>
  </select>

  <button id="sales-export" class="btn">Export CSV</button>
</div>

<!-- Sales table -->
<div class="table-wrap" style="overflow:auto; border:1px solid #e6e8eb; border-radius:12px; margin-bottom:1.5rem;">
  <table class="table" style="width:100%; border-collapse:collapse;">
    <thead>
      <tr>
        <th style="text-align:left; padding:.5rem .75rem;">Day</th>
        <th style="text-align:right; padding:.5rem .75rem;">Orders</th>
        <th style="text-align:right; padding:.5rem .75rem;">Revenue</th>
        <th style="text-align:right; padding:.5rem .75rem;">Units</th>
        <th style="text-align:right; padding:.5rem .75rem;">AOV</th>
      </tr>
    </thead>
    <tbody id="sales-14d-tbody"></tbody>
  </table>
      <!-- LIVE KPI TILES (Orders / Revenue / AOV / Returning %) -->
      <div class="overview-metrics">
        <div class="overview-metric">
          <div id="orders-value" class="metric-value">â€”</div>
          <div class="metric-label">Orders (30d)</div>
        </div>
        <div class="overview-metric">
          <div id="revenue-value" class="metric-value">â€”</div>
          <div class="metric-label">Revenue (30d)</div>
        </div>
        <div class="overview-metric">
          <div id="aov-value" class="metric-value">â€”</div>
          <div class="metric-label">AOV (30d)</div>
        </div>
        <div class="overview-metric">
          <div id="returning-value" class="metric-value">â€”</div>
          <div class="metric-label">Returning Rate (90d)</div>
        </div>
      </div>

      <!-- MINI SPARKLINE: New vs Returning (last 30 days) -->
      <div style="margin-top: 1.25rem; background: #fff; border-radius: 12px; border: 1px solid #e6e8eb; padding: 0.75rem 1rem;">
        <div style="display:flex; align-items:center; justify-content:space-between; gap:.75rem; flex-wrap:wrap;">
          <h3 style="margin:0; font-size:1rem; color:#2c3e50;">New vs Returning â€” last 30 days</h3>
          <small class="muted" id="sparkline-caption"></small>
        </div>
        <canvas id="newret-sparkline" height="60" style="width:100%; max-height:120px"></canvas>
      </div>

      <!-- 14â€‘day sales table -->
      <section class="panel" style="margin-top:1.25rem">
        <div class="panel-header" style="display:flex; align-items:center; justify-content:space-between; gap:1rem; flex-wrap:wrap">
          <h2 style="margin:0">Sales â€” Last 14 Days</h2>
          <small class="muted">Aggregated when â€œAll Storesâ€ is selected</small>
        </div>
        <div class="table-wrap">
          <table class="table" style="width:100%; border-collapse:collapse;">
            <thead>
              <tr>
                <th style="text-align:left; padding:.5rem .75rem;">Day</th>
                <th style="text-align:right; padding:.5rem .75rem;">Orders</th>
                <th style="text-align:right; padding:.5rem .75rem;">Revenue</th>
                <th style="text-align:right; padding:.5rem .75rem;">Units</th>
                <th style="text-align:right; padding:.5rem .75rem;">AOV</th>
              </tr>
            </thead>
            <tbody id="sales-14d-tbody"></tbody>
          </table>
        </div>
      </section>

      <!-- Product/Treasury modules (kept)
           You can navigate into the detailed sections below via these cards. -->
      <div class="platform-modules">
        <a href="#product-intelligence" class="module-card product-intelligence" onclick="PlatformActions?.showProductIntelligence?.()">
          <div class="module-header">
            <span class="module-icon">ğŸ“Š</span>
            <div>
              <div class="module-badge product">PRODUCT INTELLIGENCE</div>
              <h3 class="module-title">Product Intelligence</h3>
            </div>
          </div>
          <p class="module-description">Comprehensive product profitability analysis, inventory optimization, and sales performance tracking.</p>
          <ul class="module-features">
            <li>Product profitability analysis</li>
            <li>Inventory performance tracking</li>
            <li>Sales trend analysis</li>
            <li>Margin optimization</li>
          </ul>
          <div class="module-stats">
            <div class="module-stats-title">Key Metrics</div>
            <div class="stats-grid">
              <div class="stat-item">
                <div class="stat-value" id="pi-total-profit">$â€”</div>
                <div class="stat-label">Total Profit</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="pi-avg-margin">â€”%</div>
                <div class="stat-label">Avg Margin</div>
              </div>
            </div>
          </div>
        </a>

        <a href="#treasury-management" class="module-card treasury-management" onclick="PlatformActions?.showTreasuryManagement?.()">
          <div class="module-header">
            <span class="module-icon">ğŸ’°</span>
            <div>
              <div class="module-badge treasury">TREASURY MANAGEMENT</div>
              <h3 class="module-title">Treasury Management</h3>
            </div>
          </div>
          <p class="module-description">Cash flow forecasting, working capital optimization, and financial intelligence for strategic planning.</p>
          <ul class="module-features">
            <li>90-day tactical forecasting</li>
            <li>6-month strategic projections</li>
            <li>Working capital optimization</li>
            <li>Cash conversion cycle analysis</li>
          </ul>
          <div class="module-stats">
            <div class="module-stats-title">Key Metrics</div>
            <div class="stats-grid">
              <div class="stat-item">
                <div class="stat-value" id="tm-wc-oppty">$â€”</div>
                <div class="stat-label">WC Opportunity</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="tm-ccc-days">â€”</div>
                <div class="stat-label">CCC Days</div>
              </div>
            </div>
          </div>
        </a>
      </div>
    </section>

    <!-- ===== Top / Bottom SKUs & Repeat Rates ===== -->
    <section class="panel">
      <div class="panel-header">
        <h2 style="margin:0">Top SKUs</h2>
        <div class="controls" style="display:flex; gap:.5rem; align-items:center; flex-wrap:wrap">
          <label style="display:flex; gap:.25rem; align-items:center;">
            Store:
            <select id="top-skus-store" style="min-width:220px"></select>
          </label>
          <label style="display:flex; gap:.25rem; align-items:center;">
            Window:
            <select id="top-skus-days">
              <option value="7">7d</option>
              <option value="14">14d</option>
              <option value="30" selected>30d</option>
              <option value="90">90d</option>
              <option value="180">180d</option>
              <option value="365">365d</option>
            </select>
          </label>
          <label style="display:flex; gap:.25rem; align-items:center;">
            Include 365â€‘day cols
            <input type="checkbox" id="top-skus-365" checked>
          </label>
          <label style="display:flex; gap:.25rem; align-items:center;">
            Limit:
            <input id="top-skus-limit" type="number" min="1" max="500" value="50" style="width:80px">
          </label>
          <button id="top-skus-refresh" class="btn btn-secondary">Refresh</button>
        </div>
      </div>
      <div class="table-wrap">
        <table class="table" style="width:100%; border-collapse:collapse;">
          <thead>
            <tr>
              <th style="text-align:left; padding:.5rem .75rem;">SKU</th>
              <th style="text-align:left; padding:.5rem .75rem;">Title</th>
              <th style="text-align:right; padding:.5rem .75rem;">Units (Wnd)</th>
              <th style="text-align:right; padding:.5rem .75rem;">Revenue (Wnd)</th>
              <th class="col-365" style="text-align:right; padding:.5rem .75rem;">Units (365d)</th>
              <th class="col-365" style="text-align:right; padding:.5rem .75rem;">Revenue (365d)</th>
            </tr>
          </thead>
          <tbody id="top-skus-tbody"></tbody>
        </table>
      </div>
    </section>

    <section class="panel">
      <div class="panel-header">
        <h2 style="margin:0">Bottom SKUs</h2>
        <div class="controls" style="display:flex; gap:.5rem; align-items:center; flex-wrap:wrap">
          <label style="display:flex; gap:.25rem; align-items:center;">
            Store:
            <select id="bottom-skus-store" style="min-width:220px"></select>
          </label>
          <label style="display:flex; gap:.25rem; align-items:center;">
            Window:
            <select id="bottom-skus-days">
              <option value="7">7d</option>
              <option value="14">14d</option>
              <option value="30" selected>30d</option>
              <option value="90">90d</option>
              <option value="180">180d</option>
              <option value="365">365d</option>
            </select>
          </label>
          <label style="display:flex; gap:.25rem; align-items:center;">
            Include 365â€‘day cols
            <input type="checkbox" id="bottom-skus-365" checked>
          </label>
          <label style="display:flex; gap:.25rem; align-items:center;">
            Limit:
            <input id="bottom-skus-limit" type="number" min="1" max="500" value="50" style="width:80px">
          </label>
          <button id="bottom-skus-refresh" class="btn btn-secondary">Refresh</button>
        </div>
      </div>
      <div class="table-wrap">
        <table class="table" style="width:100%; border-collapse:collapse;">
          <thead>
            <tr>
              <th style="text-align:left; padding:.5rem .75rem;">SKU</th>
              <th style="text-align:left; padding:.5rem .75rem;">Title</th>
              <th style="text-align:right; padding:.5rem .75rem;">Units (Wnd)</th>
              <th style="text-align:right; padding:.5rem .75rem;">Revenue (Wnd)</th>
              <th class="col-365" style="text-align:right; padding:.5rem .75rem;">Units (365d)</th>
              <th class="col-365" style="text-align:right; padding:.5rem .75rem;">Revenue (365d)</th>
            </tr>
          </thead>
          <tbody id="bottom-skus-tbody"></tbody>
        </table>
      </div>
    </section>

    <section class="panel">
      <div class="panel-header" style="display:flex; align-items:center; justify-content:space-between; gap:1rem; flex-wrap:wrap">
        <h2 style="margin:0">Repeat Rates</h2>
        <div class="controls" style="display:flex; gap:.5rem; align-items:center; flex-wrap:wrap">
          <label style="display:flex; gap:.25rem; align-items:center;">
            Store:
            <select id="repeat-store" style="min-width:220px"></select>
          </label>
          <label style="display:flex; gap:.25rem; align-items:center;">
            Show Avg LTV
            <input type="checkbox" id="repeat-show-ltv" checked>
          </label>
          <button id="repeat-refresh" class="btn btn-secondary">Refresh</button>
        </div>
      </div>
      <div class="table-wrap">
        <table class="table" style="width:100%; border-collapse:collapse;">
          <thead>
            <tr>
              <th style="text-align:left; padding:.5rem .75rem;">Store</th>
              <th style="text-align:right; padding:.5rem .75rem;">Customers</th>
              <th style="text-align:right; padding:.5rem .75rem;">Oneâ€‘time</th>
              <th style="text-align:right; padding:.5rem .75rem;">Repeat</th>
              <th style="text-align:right; padding:.5rem .75rem;">Repeat %</th>
              <th class="col-ltv" style="text-align:right; padding:.5rem .75rem;">Avg LTV (repeat)</th>
            </tr>
          </thead>
          <tbody id="repeat-tbody"></tbody>
        </table>
      </div>
    </section>

    <!-- ===================== Product Intelligence (kept) ===================== -->
    <section id="product-intelligence-section" class="phase-section product-intelligence">
      <a href="#overview" class="back-button" onclick="PlatformActions?.showOverview?.()">â† Back to Overview</a>

      <div class="phase-header">
        <span class="phase-badge product">PRODUCT INTELLIGENCE</span>
        <h1 class="phase-title">ğŸ“Š Product Intelligence Analytics</h1>
      </div>

      <p style="font-size:1.1rem; color:var(--text-light); margin-bottom:2rem;">
        Upload NetSuite exports to analyze profitability, inventory health, and sales trends by SKU and customer.
      </p>

      <!-- Upload grid -->
      <div class="upload-grid">
        <div class="upload-card">
          <div class="status-indicator" id="cost-status"></div>
          <span class="upload-icon">ğŸ“</span>
          <div class="upload-title">Item Cost CSV</div>
          <div class="upload-description">
            <strong>NetSuite Path:</strong> Reports â†’ Inventory â†’ Item Cost<br />
            <strong>Required:</strong> Item, Avg Item Rate, Avg Est. Unit Cost, Quantity
          </div>
          <input type="file" id="cost-upload" class="file-input" accept=".csv" />
        </div>

        <div class="upload-card">
          <div class="status-indicator" id="sales-status"></div>
          <span class="upload-icon">ğŸ“Š</span>
          <div class="upload-title">Sales by Item Summary (XLS)</div>
          <div class="upload-description">
            <strong>NetSuite Path:</strong> Reports â†’ Sales â†’ Sales by Item Summary<br />
            <strong>Required:</strong> Item, Description, Qty Sold, Total Revenue
          </div>
          <input type="file" id="sales-upload" class="file-input" accept=".xls,.xlsx" />
        </div>

        <div class="upload-card">
          <div class="status-indicator" id="customer-status"></div>
          <span class="upload-icon">ğŸ‘¥</span>
          <div class="upload-title">Sales by Customer Detail (XLS)</div>
          <div class="upload-description">
            <strong>NetSuite Path:</strong> Reports â†’ Sales â†’ Sales by Customer Detail<br />
            <strong>Required:</strong> Customer, Transaction Type, Date, Total Revenue
          </div>
          <input type="file" id="customer-upload" class="file-input" accept=".xls,.xlsx" />
        </div>

        <div class="upload-card">
          <div class="status-indicator" id="po-status"></div>
          <span class="upload-icon">ğŸ­</span>
          <div class="upload-title">Purchase Order Details (XLS)</div>
          <div class="upload-description">
            <strong>NetSuite Path:</strong> Reports â†’ Purchasing â†’ Purchase Order Detail<br />
            <strong>Required:</strong> Vendor, Item, Date, Total Cost, Quantity
          </div>
          <input type="file" id="po-upload" class="file-input" accept=".xls,.xlsx" />
        </div>
      </div>

      <!-- Results Panel -->
      <div id="product-results-panel" class="results-panel" style="display:none;">
        <h3 style="margin-top:0; color:var(--text-dark);">ğŸ“Š Product Intelligence Results</h3>
        <div id="product-results-content" class="results-content"></div>
      </div>

      <!-- Charts -->
      <div class="dashboard-grid">
        <div class="chart-container">
          <h3 class="chart-title"><span class="chart-icon">ğŸ“ˆ</span> Profit vs Loss Analysis</h3>
          <canvas id="product-profit-chart" width="400" height="300"></canvas>
        </div>

        <div class="chart-container">
          <h3 class="chart-title"><span class="chart-icon">ğŸ¯</span> Product Performance</h3>
          <canvas id="product-performance-chart" width="400" height="300"></canvas>
        </div>
      </div>

      <!-- Actions -->
      <div class="action-buttons">
        <button class="btn btn-primary" onclick="ProductIntelligence?.generateAnalysis?.()">ğŸ“Š Generate Analysis</button>
        <button class="btn btn-secondary" onclick="ProductIntelligence?.optimizePortfolio?.()">ğŸ¯ Optimize Portfolio</button>
        <button class="btn btn-warning" onclick="ProductIntelligence?.exportLosingItems?.()">ğŸ“‰ Export Losing Items</button>
        <button class="btn btn-danger" onclick="ProductIntelligence?.exportStockoutRisks?.()">ğŸ“¦ Export Stockout Risks</button>
        <button class="btn btn-info" onclick="ProductIntelligence?.exportInventoryOptimization?.()">ğŸ­ Inventory Optimization</button>
        <button class="btn btn-success" onclick="ProductIntelligence?.exportAllItems?.()">ğŸ“„ Complete Analysis</button>
        <button class="btn btn-primary" onclick="ProductIntelligence?.exportReport?.()" style="background:linear-gradient(135deg,#6c5ce7,#a29bfe)">ğŸ“‹ Executive Summary</button>
      </div>

      <!-- Quick Export -->
      <div style="background:linear-gradient(135deg,#f8f9fa,#e9ecef); border-radius:15px; padding:1.5rem; margin:2rem 0; border:2px solid #e1e8ed; box-shadow:0 4px 15px rgba(0,0,0,.1);">
        <h4 style="margin-top:0; color:#2c3e50; display:flex; align-items:center;">
          <span style="margin-right:.5rem;">âš¡</span> Quick Export Actions
        </h4>
        <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:1rem;">
          <div style="text-align:center; padding:1rem; background:white; border-radius:10px; border:1px solid #dee2e6;">
            <button class="btn btn-warning" onclick="ProductIntelligence?.exportLosingItems?.()" style="width:100%; margin-bottom:.5rem;">ğŸ“‰ Losing Items</button>
            <small class="muted">Items requiring price review or discontinuation</small>
          </div>
          <div style="text-align:center; padding:1rem; background:white; border-radius:10px; border:1px solid #dee2e6;">
            <button class="btn btn-danger" onclick="ProductIntelligence?.exportStockoutRisks?.()" style="width:100%; margin-bottom:.5rem;">ğŸ“¦ Stockout Risks</button>
            <small class="muted">Items running low on stock needing immediate orders</small>
          </div>
          <div style="text-align:center; padding:1rem; background:white; border-radius:10px; border:1px solid #dee2e6;">
            <button class="btn btn-info" onclick="ProductIntelligence?.exportInventoryOptimization?.()" style="width:100%; margin-bottom:.5rem;">ğŸ­ Inventory Optimization</button>
            <small class="muted">Overstocked & dead stock items to liquidate</small>
          </div>
        </div>
      </div>
    </section>

    <!-- ===================== Treasury Management (kept) ===================== -->
    <section id="treasury-management-section" class="phase-section treasury-management">
      <a href="#overview" class="back-button" onclick="PlatformActions?.showOverview?.()">â† Back to Overview</a>

      <div class="phase-header">
        <span class="phase-badge treasury">TREASURY MANAGEMENT</span>
        <h1 class="phase-title">ğŸ’° Advanced Cash Flow Intelligence</h1>
      </div>

      <p style="font-size:1.1rem; color:var(--text-light); margin-bottom:2rem;">
        Enterprise-grade cash flow forecasting with predictive analytics and working capital optimization.
      </p>

      <div class="upload-grid">
        <div class="upload-card">
          <div class="status-indicator" id="gl-status"></div>
          <span class="upload-icon">ğŸ“‹</span>
          <div class="upload-title">General Ledger Data</div>
          <div class="upload-description">
            <strong>NetSuite Path:</strong> Reports â†’ Financial â†’ General Ledger<br />
            <strong>Required:</strong> Account, Account Name, Balance, Date
          </div>
          <input type="file" id="gl-upload" class="file-input" accept=".csv,.xls,.xlsx" />
        </div>

        <div class="upload-card">
          <div class="status-indicator" id="ar-status"></div>
          <span class="upload-icon">ğŸ’³</span>
          <div class="upload-title">Accounts Receivable</div>
          <div class="upload-description">
            <strong>NetSuite Path:</strong> Reports â†’ Financial â†’ A/R Aging Detail<br />
            <strong>Required:</strong> Customer, Invoice Date, Due Date, Amount
          </div>
          <input type="file" id="ar-upload" class="file-input" accept=".csv,.xls,.xlsx" />
        </div>

        <div class="upload-card">
          <div class="status-indicator" id="ap-status"></div>
          <span class="upload-icon">ğŸ’°</span>
          <div class="upload-title">Accounts Payable</div>
          <div class="upload-description">
            <strong>NetSuite Path:</strong> Reports â†’ Financial â†’ A/P Aging Detail<br />
            <strong>Required:</strong> Vendor, Bill Date, Due Date, Amount
          </div>
          <input type="file" id="ap-upload" class="file-input" accept=".csv,.xls,.xlsx" />
        </div>

        <div class="upload-card">
          <div class="status-indicator" id="cashflow-status"></div>
          <span class="upload-icon">ğŸ“Š</span>
          <div class="upload-title">Historical Cash Flow</div>
          <div class="upload-description">
            <strong>NetSuite Path:</strong> Reports â†’ Financial â†’ Cash Flow Statement<br />
            <strong>Required:</strong> Period, Operating Activities, Investing, Financing
          </div>
          <input type="file" id="cashflow-upload" class="file-input" accept=".csv,.xls,.xlsx" />
        </div>
      </div>

      <div class="status-panel">
        <h3 style="margin-top:0; color:var(--text-dark);">ğŸ“Š Processing Status & Insights</h3>
        <div id="status-messages" class="status-messages">
          <div class="status-message ready">
            <span class="status-icon">âœ…</span>
            <span class="status-text">Treasury Management: Ready</span>
            <span class="status-time" id="init-time"></span>
          </div>
        </div>
      </div>

      <div id="treasury-results-panel" class="results-panel" style="display:none;">
        <h3 style="margin-top:0; color:var(--text-dark);">ğŸ’° Treasury Management Results</h3>
        <div id="treasury-results-content" class="results-content"></div>
      </div>

      <div class="dashboard-grid">
        <div class="chart-container">
          <h3 class="chart-title"><span class="chart-icon">ğŸ“ˆ</span> 90-Day Cash Flow Forecast</h3>
          <canvas id="forecast-90-chart" width="400" height="300"></canvas>
        </div>
        <div class="chart-container">
          <h3 class="chart-title"><span class="chart-icon">ğŸ“Š</span> 6-Month Strategic Projection</h3>
          <canvas id="forecast-6m-chart" width="400" height="300"></canvas>
        </div>
        <div class="chart-container">
          <h3 class="chart-title"><span class="chart-icon">ğŸ¯</span> Working Capital Optimization</h3>
          <canvas id="working-capital-chart" width="400" height="300"></canvas>
        </div>
        <div class="chart-container">
          <h3 class="chart-title"><span class="chart-icon">ğŸ²</span> Scenario Analysis</h3>
          <canvas id="scenario-chart" width="400" height="300"></canvas>
        </div>
      </div>

      <div class="action-buttons">
        <button class="btn btn-primary" onclick="TreasuryManagement?.generateForecast?.()">ğŸ“Š Generate Forecast</button>
        <button class="btn btn-secondary" onclick="TreasuryManagement?.runScenarioAnalysis?.()">ğŸ² Run Scenario Analysis</button>
        <button class="btn btn-success" onclick="TreasuryManagement?.optimizeWorkingCapital?.()">âš™ï¸ Optimize Working Capital</button>
        <button class="btn btn-warning" onclick="TreasuryManagement?.generateExecutiveReport?.()">ğŸ“„ Executive Report</button>
      </div>
    </section>
  </div>

  <!-- Scripts: metrics must come before dashboard so hooks exist -->
  <script src="web/metrics.js"></script>
  <script src="js/dashboard.js"></script>
</body>
</html>